<!DOCTYPE html>
<html>
  <head>
    <title>Validation - Solid Layer Documentation</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="../.docs-compiled/assets/css/font-awesome.css">
    <link rel="stylesheet" href="../.docs-compiled/assets/css/slayer.css">
  </head>
  <body>
    <nav class="navbar">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="navbar-brand" href="#">S.layer</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="nav-link active-slayer"><a href="#">Documentation</a></li>
                <li class="nav-link"><a href="#">Forum</a></li>
                <li>
                    <form class="navbar-form navbar-left">
                        <div class="form-group has-feedback">
                            <input type="text" class="form-control" placeholder="Search">
                            <i class="glyphicon glyphicon-search form-control-feedback"></i>
                        </div>
                    </form>
                </li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</nav>    <div class="container">
      <div class="row">
        <div class="col-md-3 version">
          <div class="btn-group">
  <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    v1.4.0 <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="#">v1.4.1</a></li>
    <li><a href="#">v1.4.2</a></li>
    <li><a href="#">v1.4.3</a></li>
    <li><a href="#">v1.4.4</a></li>
  </ul>
</div>
        </div>
        <div class="col-md-9">
            <h1>Validation</h1>
        </div>
      </div>
      <div class="row">
        <div class="sidebar col-md-3">
            <ul class="sidebar-level-1"><li class="menu-level-1"><div class="nav-menu-title">Prologue</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="prologue-change-log.html">Change Log</a></li><li class="menu-level-2"><a href="prologue-contribution-guide.html">Contribution Guide</a></li></ul></li><li class="menu-level-1"><div class="nav-menu-title">Setup</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="index.html">Installation</a></li><li class="menu-level-2"><a href="setup-configuration.html">Configuration</a></li></ul></li><li class="menu-level-1"><div class="nav-menu-title">Modular-MVC</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="modular-mvc-module.html">Module</a></li><li class="menu-level-2"><a href="modular-mvc-controller.html">Controller</a></li><li class="menu-level-2"><a href="modular-mvc-view.html">View</a></li><li class="menu-level-2"><a href="modular-mvc-model.html">Model</a></li></ul></li><li class="menu-level-1"><div class="nav-menu-title">Supporting Structure</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="supporting-structure-error-handler.html">Error Handler</a></li><li class="menu-level-2"><a href="supporting-structure-routing.html">Routing</a></li><li class="menu-level-2"><a href="supporting-structure-sandbox.html">Sandbox</a></li><li class="menu-level-2"><a href="supporting-structure-service-provider.html">Service Provider</a></li><li class="menu-level-2"><a href="supporting-structure-storage.html">Storage</a></li><li class="menu-level-2"><a href="supporting-structure-unit-testing.html">Unit Testing</a></li><li class="menu-level-2"><a href="supporting-structure-validation.html">Validation</a></li></ul></li><li class="menu-level-1"><div class="nav-menu-title">Services</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="services-aliases.html">Aliases</a></li><li class="menu-level-2"><a href="services-auth.html">Auth</a></li><li class="menu-level-2"><a href="services-cache.html">Cache</a></li><li class="menu-level-2"><a href="services-db.html">DB</a></li><li class="menu-level-2"><a href="services-dispatcher.html">Dispatcher</a></li><li class="menu-level-2"><a href="services-filter.html">Filter</a></li><li class="menu-level-2"><a href="services-flash.html">Flash</a></li><li class="menu-level-2"><a href="services-flashbag.html">FlashBag</a></li><li class="menu-level-2"><a href="services-flysystem.html">Flysystem</a></li><li class="menu-level-2"><a href="services-lang.html">Lang</a></li><li class="menu-level-2"><a href="services-log.html">Log</a></li><li class="menu-level-2"><a href="services-mail.html">Mail</a></li><li class="menu-level-2"><a href="services-mongo.html">Mongo</a></li><li class="menu-level-2"><a href="services-redirect.html">Redirect</a></li><li class="menu-level-2"><a href="services-request.html">Request</a></li><li class="menu-level-2"><a href="services-response.html">Response</a></li><li class="menu-level-2"><a href="services-router.html">Router</a></li><li class="menu-level-2"><a href="services-session.html">Session</a></li><li class="menu-level-2"><a href="services-url.html">URL</a></li><li class="menu-level-2"><a href="services-view.html">View</a></li></ul></li><li class="menu-level-1"><div class="nav-menu-title">Misc.</div><ul class="sidebar-level-2"><li class="menu-level-2"><a href="misc-brood-console.html">Brood Console</a></li><li class="menu-level-2"><div class="nav-menu-title">Database</div><ul class="sidebar-level-3"><li class="menu-level-3"><a href="misc-database-factories.html">Factories</a></li><li class="menu-level-3"><a href="misc-database-migrations.html">Migrations</a></li></ul></li><li class="menu-level-2"><a href="misc-coding-style.html">Coding Style</a></li></ul></li></ul>

        </div>
        <div class="article col-md-9">
            <p>We definitely have something we need to validate before executing script going to other 3rd party resources such as sql server.</p>
<p>We validate data to match our needs.</p>
<p>The class <strong>Phalcon\Validation</strong> will do the job; We have sample validation classes in our <code>project-name/components/Validation</code></p>
<hr />
<h2>Creating Class Validator</h2>
<pre><code class="language-php">...

class JustAnotherValidator extends Validator
{
    public function initialize()
    {
        $this->add(&#039;email&#039;, new PresenceOf([
            &#039;message&#039; => &#039;Email is required&#039;,
        ]));

        $this->add(&#039;email&#039;, new Email([
            &#039;message&#039; => &#039;Email is not valid&#039;,
        ]));

        $this->add(&#039;email&#039;, new Uniqueness([
            &#039;model&#039;   => User::class,
            &#039;message&#039; => &#039;Email already exist&#039;
        ]));

        $this->add(&#039;password&#039;, new PresenceOf([
            &#039;message&#039; => &#039;Password is required&#039;,
        ]));

        $this->add(&#039;password&#039;, new Confirmation([
            &#039;with&#039;    => &#039;repassword&#039;,
            &#039;message&#039; => &#039;Password and Repeat Password must match&#039;,
        ]));

        $this->add(&#039;repassword&#039;, new PresenceOf([
            &#039;message&#039; => &#039;Repeat Password is required&#039;,
        ]));
    }
}
</code></pre>
<p>The above code uses <strong><em>PresenceOf</em></strong>, <strong><em>Email</em></strong>, <strong><em>Uniqueness</em></strong> and <strong><em>Confirmation</em></strong>, those classes are validators that filters a value from your data.</p>
<p>Let&#039;s assume we have this kind of data </p>
<pre><code class="language-php">$data = [
    &#039;email&#039; => &#039;johndoe&#039;,
    &#039;password&#039; => &#039;123qwe&#039;,
    &#039;repassword&#039; => &#039;qwe123&#039;,
];

# this throws error
# - email format error
# - password and repassword not match
$validator = new SomeValidator();
$validator->validate($data);
</code></pre>
<p>and we have this:</p>
<pre><code class="language-php">$data2 = [
    &#039;email&#039; => &#039;johndoe@gmail.com&#039;,
    &#039;password&#039; => &#039;123qwe&#039;,
    &#039;repassword&#039; => &#039;123qwe&#039;,
];

# this is ok, but assuming we have existing &#039;johndoe@gmail.com&#039;, so this throws error
# - email exists
$validator = new SomeValidator();
$validator->validate($data2);
</code></pre>
<hr />
<h2>Available Validators</h2>
<p>The lists below are available and mostly used by several developers, you could use them as your reference.</p>
<table>
<thead>
<tr><th>Name         </th><th>Explanation</th></tr>
</thead>
<tbody>
<tr><td>PresenceOf   </td><td>Validates that a field&#039;s value is not null or empty string.</td></tr>
<tr><td>Identical    </td><td>Validates that a field&#039;s value is the same as a specified value</td></tr>
<tr><td>Email        </td><td>Validates that field contains a valid email format</td></tr>
<tr><td>ExclusionIn  </td><td>Validates that a value is not within a list of possible values</td></tr>
<tr><td>InclusionIn  </td><td>Validates that a value is within a list of possible values</td></tr>
<tr><td>Regex        </td><td>Validates that the value of a field matches a regular expression</td></tr>
<tr><td>StringLength </td><td>Validates the length of a string</td></tr>
<tr><td>Between      </td><td>Validates that a value is between two values</td></tr>
<tr><td>Confirmation </td><td>Validates that a value is the same as another present in the data</td></tr>
<tr><td>Url          </td><td>Validates that field contains a valid URL</td></tr>
<tr><td>CreditCard   </td><td>Validates a credit card number</td></tr>
</tbody>
</table>
<hr />
<h2>Custom Validator</h2>
<p>You can create your own validation class to extend more or to suit your needs.</p>
<pre><code class="language-php">
use Phalcon\Validation\Message;
use Phalcon\Validation\Validator;
use Phalcon\Validation\ValidatorInterface;

class IpValidator extends Validator implements ValidatorInterface
{
    /**
     * Executes the validation
     *
     * @param Phalcon\Validation $validator
     * @param string $attribute
     * @return boolean
     */
    public function validate(Validation $validator, $attribute)
    {
        $value = $validator->getValue($attribute);

        if (!filter_var($value, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4 | FILTER_FLAG_IPV6)) {

            $message = $this->getOption(&#039;message&#039;);
            if (!$message) {
                $message = &#039;The IP is not valid&#039;;
            }

            $validator->appendMessage(new Message($message, $attribute, &#039;Ip&#039;));

            return false;
        }

        return true;
    }
}
</code></pre>
<p><strong><em>Note:</em></strong> always use boolean to indicate that it is validated or not.</p>

        </div>
      </div>
    </div>
  </body>

  <script src="../.docs-compiled/assets/js/jquery.js"></script>
  <script src="../.docs-compiled/assets/js/bootstrap.js"></script>
</html>
