20160808060959
$ git clone "https://github.com/phalconslayer/docs.git" "/var/www/docs/releases/20160808065453" --branch="dev" --depth="1"
git clone "https://github.com/phalconslayer/docs.git" "/var/www/docs/releases/20160808065453" --branch="dev" --depth="1"
Cloning into '/var/www/docs/releases/20160808065453'...
$ cd /var/www/docs/releases/20160808065453
$ git submodule update --init --recursive
cd /var/www/docs/releases/20160808065453
git submodule update --init --recursive


/usr/local/bin/composer
$ cd /var/www/docs/releases/20160808065453
$ /usr/local/bin/composer install --no-interaction --no-dev --prefer-dist
cd /var/www/docs/releases/20160808065453
/usr/local/bin/composer install --no-interaction --no-dev --prefer-dist
Do not run Composer as root/super user! See https://getcomposer.org/root for details
Loading composer repositories with package information
Updating dependencies
  - Installing doctrine/inflector (v1.1.0)
    Loading from cache

  - Installing illuminate/contracts (v5.2.37)
    Loading from cache

  - Installing paragonie/random_compat (v1.4.1)
    Loading from cache

  - Installing illuminate/support (v5.2.37)
    Loading from cache

  - Installing symfony/finder (v3.0.9)
    Loading from cache

  - Installing illuminate/filesystem (v5.2.37)
    Loading from cache

  - Installing illuminate/container (v5.2.37)
    Loading from cache

  - Installing illuminate/events (v5.2.37)
    Loading from cache

  - Installing psr/log (1.0.0)
    Loading from cache

  - Installing symfony/debug (v3.0.9)
    Loading from cache

  - Installing illuminate/view (v5.2.37)
    Loading from cache

  - Installing jenssegers/blade (v1.0.0)
    Loading from cache

  - Installing cebe/markdown (1.1.0)
    Loading from cache

  - Installing php-pure/themer (dev-master e807c12)
    Loading from cache

Writing lock file
Generating autoload files



$ cd /var/www/docs/releases/20160808065453
$ chmod -R 755 /var/www/docs/releases/20160808065453/app/database/production.sqlite
$ chmod -R g+s /var/www/docs/releases/20160808065453/app/database/production.sqlite
$ chown -R www-data:www-data /var/www/docs/releases/20160808065453/app/database/production.sqlite
cd /var/www/docs/releases/20160808065453
chmod -R 755 /var/www/docs/releases/20160808065453/app/database/production.sqlite
chmod -R g+s /var/www/docs/releases/20160808065453/app/database/production.sqlite
chown -R www-data:www-data /var/www/docs/releases/20160808065453/app/database/production.sqlite
chmod: cannot access ‘/var/www/docs/releases/20160808065453/app/database/production.sqlite’: No such file or directory
$ cd /var/www/docs/releases/20160808065453
$ chmod -R 755 /var/www/docs/releases/20160808065453/storage
$ chmod -R g+s /var/www/docs/releases/20160808065453/storage
$ chown -R www-data:www-data /var/www/docs/releases/20160808065453/storage
cd /var/www/docs/releases/20160808065453
chmod -R 755 /var/www/docs/releases/20160808065453/storage
chmod -R g+s /var/www/docs/releases/20160808065453/storage
chown -R www-data:www-data /var/www/docs/releases/20160808065453/storage
chmod: cannot access ‘/var/www/docs/releases/20160808065453/storage’: No such file or directory
$ cd /var/www/docs/releases/20160808065453
$ chmod -R 755 /var/www/docs/releases/20160808065453/public
$ chmod -R g+s /var/www/docs/releases/20160808065453/public
$ chown -R www-data:www-data /var/www/docs/releases/20160808065453/public
cd /var/www/docs/releases/20160808065453
chmod -R 755 /var/www/docs/releases/20160808065453/public
chmod -R g+s /var/www/docs/releases/20160808065453/public
chown -R www-data:www-data /var/www/docs/releases/20160808065453/public

$ ln -s /var/www/docs/releases/20160808065453 /var/www/docs/current-temp
$ mv -Tf /var/www/docs/current-temp /var/www/docs/current
ln -s /var/www/docs/releases/20160808065453 /var/www/docs/current-temp
mv -Tf /var/www/docs/current-temp /var/www/docs/current

$ cd /var/www/docs/releases/20160808065453
$ php ./vendor/bin/pure-themer
cd /var/www/docs/releases/20160808065453
php ./vendor/bin/pure-themer
Loading [.themer.conf]
   Writing to [public/prologue-change-log.html]
   Writing to [public/prologue-contribution-guide.html]
   Writing to [public/index.html]
   Writing to [public/setup-configuration.html]
   Writing to [public/modular-mvc-module.html]
   Writing to [public/modular-mvc-controller.html]
   Writing to [public/modular-mvc-view.html]
   Writing to [public/modular-mvc-model.html]
   Writing to [public/supporting-structure-error-handler.html]
   Writing to [public/supporting-structure-routing.html]
   Writing to [public/supporting-structure-sandbox.html]
   Writing to [public/supporting-structure-service-provider.html]
   Writing to [public/supporting-structure-storage.html]
   Writing to [public/supporting-structure-unit-testing.html]
   Writing to [public/supporting-structure-validation.html]
   Writing to [public/services-aliases.html]
   Writing to [public/services-auth.html]
   Writing to [public/services-cache.html]
   Writing to [public/services-db.html]
   Writing to [public/services-dispatcher.html]
   Writing to [public/services-filter.html]
   Writing to [public/services-flash.html]
   Writing to [public/services-flashbag.html]
   Writing to [public/services-flysystem.html]
   Writing to [public/services-lang.html]
   Writing to [public/services-log.html]
   Writing to [public/services-mail.html]
   Writing to [public/services-mongo.html]
   Writing to [public/services-redirect.html]
   Writing to [public/services-request.html]
   Writing to [public/services-response.html]
   Writing to [public/services-router.html]
   Writing to [public/services-session.html]
   Writing to [public/services-url.html]
   Writing to [public/services-view.html]
   Writing to [public/misc-brood-console.html]
   Writing to [public/misc-database-factories.html]
   Writing to [public/misc-database-migrations.html]
   Writing to [public/misc-coding-style.html]
$ echo -e "server {
    listen 80;
    server_name beta-docs.phalconslayer.com;
    root \"/var/www/docs/releases/20160808065453/public\";

    index index.html index.htm index.php;

    charset utf-8;

    location / {
        try_files \$uri \$uri/ /index.php?\$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    access_log off;
    error_log  /var/log/nginx/docs.phalconslayer.com-error.log error;

    sendfile off;

    client_max_body_size 100m;

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME \$document_root\$fastcgi_script_name;
        fastcgi_intercept_errors off;
        fastcgi_buffer_size 16k;
        fastcgi_buffers 4 16k;
    }

    location ~ /\.ht {
        deny all;
    }
}
" > /etc/nginx/sites-available/beta-docs.phalconslayer.com
echo -e "server {
    listen 80;
    server_name beta-docs.phalconslayer.com;
    root \"/var/www/docs/releases/20160808065453/public\";

    index index.html index.htm index.php;

    charset utf-8;

    location / {
        try_files \$uri \$uri/ /index.php?\$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    access_log off;
    error_log  /var/log/nginx/docs.phalconslayer.com-error.log error;

    sendfile off;

    client_max_body_size 100m;

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME \$document_root\$fastcgi_script_name;
        fastcgi_intercept_errors off;
        fastcgi_buffer_size 16k;
        fastcgi_buffers 4 16k;
    }

    location ~ /\.ht {
        deny all;
    }
}
" > /etc/nginx/sites-available/beta-docs.phalconslayer.com

$ sudo service nginx restart
sudo service nginx restart
* Restarting nginx nginx
   ...done.
|=> Successfully deployed release 20160808065453
|=> No releases to prune from the server